<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        <%= title %>
    </title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        .product-list {
            list-style: none;
            padding: 0;
        }

        .product-item {
            border: 1px solid #ccc;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }

        .product-item h3 {
            margin: 0;
        }

        .product-item form {
            margin-top: 10px;
        }

        .product-item button {
            background-color: #007BFF;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
        }

        .product-item button:hover {
            background-color: #0056b3;
        }
    </style>
</head>

<body>

    <% if (userIsLoggedIn) { %>
        <a href="/cart/getAll">Cart</a>
        <br><br>
    <% } %>

    <!-- Sorting and Filtering Section -->
    <div>
        <!-- Form for product search -->
        <form method="GET" action="/products/search">
            <input type="text" name="productName" placeholder="Search for a product" required>
            <button type="submit">Search</button><br>
        </form>

        <!-- Price Filter -->
        <form method="GET" action="/products/filterByPrice">
            <br><label for="minPrice">Min Price:</label>
            <input type="number" id="minPrice" name="minPrice" placeholder="Min Price">
            <label for="maxPrice">Max Price:</label>
            <input type="number" id="maxPrice" name="maxPrice" placeholder="Max Price">
            <button type="submit">Filter by Price</button><br>
        </form>

        <!-- Category Filter -->
        <form method="GET" action="/products/filterByCategory">
            <br><label for="category">Category:</label><br>
            <% categories.forEach(category=> { %>
                <label>
                    <input type="radio" name="category" value="<%= category %>">
                    <%= category %>
                </label><br>
                <% }) %>
                    <button type="submit">Filter by Category</button><br>
        </form>

        <!-- Size Filter -->
        <form method="GET" action="/products/filterBySize">
            <br><label for="size">Size:</label><br>
            <% sizes.forEach(size=> { %>
                <label>
                    <input type="radio" name="size" value="<%= size %>">
                    <%= size %>
                </label><br>
                <% }) %>
                    <button type="submit">Filter by Size</button><br>
        </form>

        <!-- Sort by Price -->
        <form method="GET" action="/products/sortByPrice">
            <br><label for="sortOrder">Sort by Price:</label>
            <select id="sortOrder" name="sortOrder">
                <option value="ASC">Low to High</option>
                <option value="DESC">High to Low</option>
            </select>
            <button type="submit">Sort</button>
        </form>
    </div>

    <!-- Product List -->
    <ul class="product-list">
        <% if (products && products.length) { %>
            <% products.forEach(product=> { %>
                <li class="product-item">
                    <h3>
                        <a href="/products/<%= product._id %>">
                          <%= product.name %>
                        </a>
                    </h3>

                    <p>Price: $<%= product.price %></p>

                    <p>Size: <%= product.size %></p>
                    
                    <p>Category: <%= product.category %></p>

                    <p>Description: <%= product.description %></p>

                    <!-- Add to Cart Form -->
                    <form action="/cart/addItem" method="POST">
                        <input type="hidden" name="productId" value="<%= product._id %>">
                        <label for="quantity_<%= product._id %>">Quantity:</label>
                        <input type="number" id="quantity_<%= product._id %>" name="quantity" value="1" min="1"
                            required>
                        <button type="submit">Add to Cart</button>
                    </form>
                </li>
                <% }) %>
                    <% } else { %>
                        <li>No products available.</li>
                        <% } %>
    </ul>
    <br>
    <a href="/">Homepage</a>
</body>

</html>